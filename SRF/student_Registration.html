<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <title>Student Registration Form</title>
    <link rel="stylesheet" href="style.css">
     <link rel="preconnect" href="https://fonts.googleapis.com">
  </head>
  <body>
    <div class="wrapper">
      <header>
        <h2 id="formTitle">Student Master Enrollment</h2>
      </header>

      <form id="admissionForm" class="card">
        <fieldset>
          <legend>1. Student Personal Details</legend>
          <div class="form-grid">
            <label>Full Name <input type="text" id="name" placeholder="Legal Full Name" required/></label>
            <label>Date of Birth <input type="date" id="dob" required></label>
            <label>Gender
              <select id="gender">
                <option>Male</option><option>Female</option><option>Other</option>
              </select>
            </label>
            <label>Blood Group
              <select id="bloodGroup">
                <option>A+</option><option>A-</option><option>B+</option><option>B-</option>
                <option>O+</option><option>O-</option><option>AB+</option><option>AB-</option>
              </select>
            </label>
            <label>Category (Caste)
              <select id="caste">
                <option value="General">General (OC)</option>
                <option value="OBC">OBC (BC)</option>
                <option value="SC">SC</option>
                <option value="ST">ST</option>
                <option value="Other">Other</option>
              </select>
            </label>
            <label>Nationality <input type="text" id="nationality" value="Indian"></label>
            <label>Religion <input type="text" id="religion" placeholder="e.g. Hindu, Muslim, etc."></label>
            <label>Aadhar Number <input type="text" id="aadhar" placeholder="0000 0000 0000"/></label>
            <label>Email ID <input type="email" id="email" required placeholder="name@example.com"/></label>
            <label>Student Phone <input type="tel" id="phone" placeholder="+91 "/></label>
            <label>Place of Birth <input type="text" id="placeOfBirth" placeholder="City/Town"></label>
          </div>
        </fieldset>

        <fieldset>
          <legend>2. Family Information</legend>
          <div class="form-grid">
            <label>Father's Name <input type="text" id="fatherName" required></label>
            <label>Mother's Name <input type="text" id="motherName" ></label>
            <label>Guardian Phone <input type="tel" id="parentPhone" ></label>
            <label>Course Name <input type="text" id="course" placeholder="e.g. B.Tech CS"/></label>
          </div>
        </fieldset>

        <fieldset>
          <legend>3. Address & Location Details</legend>
          <div class="form-grid">
            <label class="span-full">Residential Address <textarea id="address" rows="2" placeholder="House No, Street, Locality..."></textarea></label>
            <label>City <input type="text" id="currentLocation" placeholder="City"></label>
            <label>State <input type="text" id="state" placeholder="State/Province"></label>
            <label>Pincode <input type="text" id="pincode" placeholder="6-digit ZIP"></label>
            <label>Country <input type="text" id="country" value="India"></label>
            <label>Mother Tongue <input type="text" id="motherTongue" placeholder="e.g. Tamil, Hindi, etc."></label>
            <label>Father's Occupation <input type="text" id="fOccupation" placeholder="e.g. Engineer, Teacher, etc."></label>
            <label>Mother's Occupation <input type="text" id="mOccupation" placeholder="e.g. Nurse, Teacher, etc."></label>
            <input type="hidden" id="permAddress">

          </div>
        </fieldset>

        
        <button type="button" id="submitBtn" onclick="handleRegistration()">Submit Final Registration</button>
      </form>

      <div class="table-wrapper">
        <table>
          <thead>
            <tr>
              <th>Basic Info</th>
              <th>Aadhar & Bio</th>
              <th>Contact & Family</th>
              <th>Location</th>
              <th>Course</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody id="registryBody"></tbody>
        </table>
      </div>
    </div>

    <div id="successModal" class="modal-overlay">
      <div class="popup">
        <h3 style="color: #10b981; margin-top:0;"> Success</h3>
        <p id="popupMsg" style="color: #64748b; font-size: 14px;"></p>
        <button onclick="closePopup()">Continue</button>
      </div>
    </div>

    <script>
      let students = [];
      let editIndex = null;

      function handleRegistration() {
        const form = document.getElementById("admissionForm");
        const studentData = {
          name: document.getElementById("name").value,
          dob: document.getElementById("dob").value,
          gender: document.getElementById("gender").value,
          bloodGroup: document.getElementById("bloodGroup").value,
          nationality: document.getElementById("nationality").value,
          religion: document.getElementById("religion").value,
          aadhar: document.getElementById("aadhar").value,
          email: document.getElementById("email").value,
          phone: document.getElementById("phone").value,
          birthPlace: document.getElementById("placeOfBirth").value,
          father: document.getElementById("fatherName").value,
          mother: document.getElementById("motherName").value,
          pPhone: document.getElementById("parentPhone").value,
          course: document.getElementById("course").value,
          address: document.getElementById("address").value,
          city: document.getElementById("currentLocation").value,
          state: document.getElementById("state").value,
          pincode: document.getElementById("pincode").value,
          country: document.getElementById("country").value,
        };

        if (!studentData.name || !studentData.email || !studentData.dob) {
          alert("Error: Name, Email, and DOB are required.");
          return;
        }

        if (editIndex === null) {
          students.push(studentData);
          showPopup("Student Record Created!");
        } else {
          students[editIndex] = studentData;
          editIndex = null;
          document.getElementById("submitBtn").innerText = "Submit Final Registration";
          document.getElementById("formTitle").innerText = "Student Master Enrollment";
          showPopup("Record Updated Successfully!");
        }

        renderTable();
        form.reset();
      }

      function showPopup(msg) {
        document.getElementById("popupMsg").innerText = msg;
        document.getElementById("successModal").style.display = "flex";
      }

      function closePopup() {
        document.getElementById("successModal").style.display = "none";
      }

      function renderTable() {
        const tableBody = document.getElementById("registryBody");
        tableBody.innerHTML = "";
        students.forEach((student, index) => {
          const row = document.createElement("tr");
          row.innerHTML = `
                <td><strong>${student.name}</strong><br><small>${student.gender} | ${student.dob}</small></td>
                <td>${student.aadhar || 'N/A'}<br><small>Blood: ${student.bloodGroup}</small></td>
                <td>${student.email}<br><small>F: ${student.father}</small></td>
                <td>${student.city}<br><small>${student.state}, ${student.country}</small></td>
                <td><span class="course-tag">${student.course || 'None'}</span></td>
                <td>
                    <button class="btn-edit" onclick="editStudent(${index})">Edit</button>
                    <button class="btn-delete" onclick="deleteStudent(${index})">Del</button>
                </td>
            `;
          tableBody.appendChild(row);
        });
      }

      function editStudent(index) {
        const s = students[index];
        document.getElementById("name").value = s.name;
        document.getElementById("dob").value = s.dob;
        document.getElementById("gender").value = s.gender;
        document.getElementById("bloodGroup").value = s.bloodGroup;
        document.getElementById("nationality").value = s.nationality;
        document.getElementById("religion").value = s.religion;
        document.getElementById("aadhar").value = s.aadhar;
        document.getElementById("email").value = s.email;
        document.getElementById("phone").value = s.phone;
        document.getElementById("placeOfBirth").value = s.birthPlace;
        document.getElementById("fatherName").value = s.father;
        document.getElementById("motherName").value = s.mother;
        document.getElementById("parentPhone").value = s.pPhone;
        document.getElementById("course").value = s.course;
        document.getElementById("address").value = s.address;
        document.getElementById("currentLocation").value = s.city;
        document.getElementById("state").value = s.state;
        document.getElementById("pincode").value = s.pincode;
        document.getElementById("country").value = s.country;

        editIndex = index;
        document.getElementById("submitBtn").innerText = "Update Record";
        document.getElementById("formTitle").innerText = "Editing: " + s.name;
        window.scrollTo({ top: 0, behavior: 'smooth' });
      }

      function deleteStudent(index) {
        if (confirm("Permanently delete this student?")) {
          students.splice(index, 1);
          renderTable();
        }
      }
    </script>
  </body>
</html>